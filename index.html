<!--
 ▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽▽

  更新履歴
  No001 2025/0/ うるす

△△△△△△△△△△△△△△△△△△△△△△△△△△△△△
-->

<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>簡易戦闘シミュレーション</title>
</head>

<body>
  <h1>エモクロアTRPG：簡易戦闘シミュレーションツール</h1>
  <label>ループ回数<input type="number" id="loopCount" value="100000"></label><br>

  <label>攻撃種別:
    <select id="attackType" onchange="toggleInput()">
      <option value="none">選択してください</option>
      <option value="martialArts">〈＊格闘〉または〈武術〉:【成功数】D3 + 武器攻撃力 + 〈ストレングス〉の技能レベル</option>
      <option value="mystery">〈★奥義〉【成功数】D6 + 武器攻撃力 + 〈ストレングス〉の技能レベル</option>
      <option value="throw">〈＊投擲〉:【成功数】 + 武器攻撃力</option>
      <option value="shooting">〈★射撃〉【成功数】 + 武器攻撃力</option>
      <!-- <option value="other">その他</option> -->
    </select>
  </label><br>

  <label>技能レベル（1～3の整数）: <input type="number" id="level" value="3"></label><br>
  <label>判定値(1～9の整数): <input type="number" id="judge" value="5"></label><br>

  <!-- 各種攻撃タイプの入力欄（最初は非表示） -->
  <div id="martialArtsFields" style="display:none;">
    <label>武器攻撃力（整数またはダイス形式（例：2D6、1D2））: <input type="text" id="weaponAttackPower" value="5"></label><br>
    <label>〈ストレングス〉の技能レベル（1～3の整数）: <input type="number" id="str" value="3"></label><br>
  </div>

  <div id="mysteryFields" style="display:none;">
    <label>武器攻撃力（整数または1D2形式）: <input type="text" id="weaponAttackPower" value="5"></label><br>
    <label>〈ストレングス〉の技能レベル（1～3の整数）: <input type="number" id="str" value="3"></label><br>
    <label>
      特殊効果:連撃使用チェック:
      <input type="checkbox" id="rengekiFlg">
    </label><br>
  </div>

  <div id="throwFields" style="display:none;">
    <label>武器攻撃力（整数またはダイス形式（例：2D6、1D2））: <input type="text" id="weaponAttackPower" value="5"></label><br>
  </div>

  <div id="shootingFields" style="display:none;">
    <label>武器攻撃力（整数またはダイス形式（例：2D6、1D2））: <input type="text" id="weaponAttackPower" value="5"></label><br>
  </div>

  <div id="errorDiv" style="color: red; margin-top: 10px; font-weight: bold;"></div>

  <h2>1Rの平均与ダメージ: <span id="avrDamage">---</span></h2>

  <p id="progressText" style="font-weight: bold;"></p>
  <progress id="progressBar" value="0" max="100" style="width: 50%; display: none;"></progress>
  <button id="startButton" onclick="loop()">平均をシミュレート</button>
  <button id="cancelButton" onclick="cancelLoop()" style="display: none;">キャンセル</button>

  <!-- JavaScriptファイルを読み込む -->
  <script type="module" src="main.js"></script>

  <script>
    function toggleInput() {
      const selected = document.getElementById("attackType").value;

      // 存在するフィールドIDを列挙
      const allFields = [
        "martialArtsFields",
        "mysteryFields",
        "throwFields",
        "shootingFields"
      ];

      // すべてのフィールドを非表示
      allFields.forEach(id => {
        const elem = document.getElementById(id);
        if (elem) {
          elem.style.display = "none";
        }
      });

      // 選択された技能に応じて表示
      const selectedId = selected + "Fields";
      const selectedElem = document.getElementById(selectedId);
      if (selectedElem) {
        selectedElem.style.display = "block";
      }
    }
  </script>
</body>

</html>